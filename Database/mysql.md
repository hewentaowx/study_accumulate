### MysqlğŸ’»
#### äº‹åŠ¡

1. **åŸå­æ€§ï¼š**äº‹åŠ¡æ˜¯æœ€å°çš„æ‰§è¡Œå•ä½ï¼Œä¸å…è®¸åˆ†å‰²ã€‚äº‹åŠ¡çš„åŸå­æ€§ç¡®ä¿åŠ¨ä½œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå®Œå…¨ä¸èµ·ä½œç”¨ã€‚
1. **ä¸€è‡´æ€§ï¼š**æ‰§è¡Œäº‹åŠ¡å‰åï¼Œæ•°æ®ä¿æŒä¸€è‡´ï¼Œå¤šä¸ªäº‹åŠ¡å¯¹åŒä¸€ä¸ªæ•°æ®è¯»å–çš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚
1. **éš”ç¦»æ€§ï¼š**å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªç”¨æˆ·çš„äº‹åŠ¡ä¸è¢«å…¶ä»–äº‹åŠ¡æ‰€å¹²æ‰°ï¼Œå„å¹¶å‘äº‹åŠ¡ä¹‹é—´æ•°æ®åº“æ˜¯ç‹¬ç«‹çš„ã€‚
1. **æŒä¹…æ€§ï¼š**ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ä¹‹åï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­çš„æ•°æ®çš„æ”¹å˜æ˜¯æŒä¹…çš„ï¼ŒåŠæ—¶æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿå§åº”è¯¥å¯¹å…¶æœ‰ä»»åŠ¡å½±å“ã€‚
#### å¹¶å‘äº‹åŠ¡å¸¦æ¥å“ªäº›é—®é¢˜
åœ¨å…¸å‹çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¤šä¸ªäº‹åŠ¡å¹¶å‘è¿è¡Œï¼Œç»å¸¸ä¼šæ“ä½œç›¸åŒçš„æ•°æ®æ¥å®Œæˆå„è‡ªçš„ä»»åŠ¡ï¼ˆå¤šä¸ªç”¨æˆ·å¯¹ç»Ÿä¸€æ•°æ®è¿›è¡Œæ“ä½œï¼‰ã€‚å¹¶å‘è™½ç„¶æ˜¯å¿…é¡»çš„ï¼Œä½†å¯èƒ½å¯¼è‡´ä»¥ä¸‹é—®é¢˜ï¼š

- **è„è¯»ï¼š**å½“ä¸€ä¸ªäº‹åŠ¡æ­£åœ¨è®¿é—®æ•°æ®å¹¶ä¸”å¯¹æ•°æ®è¿›è¡Œäº†ä¿®æ”¹ï¼Œè€Œè¿™ç§ä¿®æ”¹è¿˜æ²¡æœ‰æäº¤åˆ°æ•°æ®åº“ä¸­ï¼Œè¿™æ—¶å¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®äº†è¿™ä¸ªæ•°æ®ï¼Œç„¶åä½¿ç”¨äº†è¿™ä¸ªæ•°æ®ã€‚å› ä¸ºè¿™ä¸ªæ•°æ®æ˜¯è¿˜æ²¡æœ‰æäº¤çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦å¤–ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°çš„è¿™ä¸ªæ•°æ®æ˜¯â€œè„æ•°æ®â€ï¼Œä¾æ®â€œè„æ•°æ®â€æ‰€åšçš„æ“ä½œå¯èƒ½æ˜¯ä¸æ­£ç¡®çš„ã€‚
- **ä¸¢å¤±ä¿®æ”¹ï¼š**æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡è¯»å–ä¸€ä¸ªæ•°æ®æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®äº†è¯¥æ•°æ®ï¼Œé‚£ä¹ˆåœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¸­ä¿®æ”¹äº†è¿™ä¸ªæ•°æ®åï¼Œç¬¬äºŒä¸ªäº‹åŠ¡ä¹Ÿä¿®æ”¹äº†è¿™ä¸ªæ•°æ®ã€‚è¿™æ ·ç¬¬ä¸€ä¸ªäº‹åŠ¡å†…çš„ä¿®æ”¹ç»“æœå°±è¢«ä¸¢å¤±ï¼Œå› æ­¤ç§°ä¸ºä¸¢å¤±ä¿®æ”¹ã€‚	ä¾‹å¦‚ï¼šäº‹åŠ¡1è¯»å–æŸè¡¨ä¸­çš„æ•°æ®A=20ï¼Œäº‹åŠ¡2ä¹Ÿè¯»å–A=20ï¼Œäº‹åŠ¡1ä¿®æ”¹A=A-1ï¼Œäº‹åŠ¡2ä¹Ÿä¿®æ”¹A=A-1ï¼Œæœ€ç»ˆç»“æœA=19ï¼Œäº‹åŠ¡1çš„ä¿®æ”¹è¢«ä¸¢å¤±ã€‚
- **ä¸å¯é‡å¤è¯»ï¼š**æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡å†…å¤šæ¬¡è¯»åŒä¸€æ•°æ®ã€‚åœ¨è¿™ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰ç»“æŸæ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡ä¹Ÿè®¿é—®è¯¥æ•°æ®ã€‚é‚£ä¹ˆï¼Œåœ¨ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¸­çš„ä¸¤æ¬¡è¯»æ•°æ®ä¹‹é—´ï¼Œç”±äºç¬¬äºŒä¸ªäº‹åŠ¡çš„ä¿®æ”¹å¯¼è‡´ç¬¬ä¸€ä¸ªäº‹åŠ¡ä¸¤æ¬¡è¯»å–çš„æ•°æ®å¯èƒ½ä¸å¤ªä¸€æ ·ã€‚è¿™å°±å‘ç”Ÿäº†åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®æ˜¯ä¸ä¸€æ ·çš„æƒ…å†µï¼Œå› æ­¤ç§°ä¸ºä¸å¯é‡å¤è¯»ã€‚
- **å¹»è¯»ï¼š**å¹»è¯»ä¸ä¸å¯é‡å¤è¯»ç±»ä¼¼ã€‚å®ƒå‘ç”Ÿåœ¨ä¸€ä¸ªäº‹åŠ¡ï¼ˆT1ï¼‰è¯»å–äº†å‡ è¡Œæ•°æ®ï¼Œæ¥ç€å¦ä¸€ä¸ªå¹¶å‘äº‹åŠ¡ï¼ˆT2ï¼‰æ’å…¥äº†ä¸€äº›æ•°æ®æ—¶ã€‚åœ¨éšåçš„æŸ¥è¯¢ä¸­ï¼Œç¬¬ä¸€ä¸ªäº‹åŠ¡ï¼ˆT1ï¼‰å°±ä¼šå‘ç°å¤šäº†ä¸€äº›åŸæœ¬ä¸å­˜åœ¨çš„è®°å½•ï¼Œå°±å¥½åƒå‘ç”Ÿäº†å¹»è§‰ä¸€æ ·ï¼Œæ‰€ä»¥ç§°ä¸ºå¹»è¯»ã€‚
#### äº‹åŠ¡éš”ç¦»çº§åˆ«æœ‰å“ªäº›ï¼ŸMysqlçš„é»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ï¼Ÿ
SQLæ ‡å‡†å®šä¹‰äº†å››ä¸ªéš”ç¦»çº§åˆ«ï¼š

- **READ-UNCOMMITTED(è¯»å–æœªæäº¤)ï¼š**æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œå…è®¸è¯»å–å°šæœªæäº¤çš„æ•°æ®å˜æ›´ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„è¯»ã€å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»ã€‚
- **READ-COMMITTED(è¯»å–å·²æäº¤)ï¼š**å…è®¸è¯»å–å¹¶å‘äº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œå¯ä»¥é˜»æ­¢è„è¯»ï¼Œä½†æ˜¯å¹»è¯»å’Œä¸å¯é‡å¤è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿã€‚
- **REPEATABLE-READ(å¯é‡å¤è¯»)ï¼š**å¯¹åŒä¸€å­—æ®µçš„å¤šæ¬¡è¯»å–ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®æ˜¯è¢«æœ¬èº«äº‹åŠ¡è‡ªå·±æ‰€ä¿®æ”¹ï¼Œå¯ä»¥é˜»æ­¢è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†å¹»è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿã€‚
- **SERIALIZABLE(å¯ä¸²è¡ŒåŒ–)ï¼š**æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®Œå…¨æœä»ACIDçš„éš”ç¦»çº§åˆ«ã€‚æ‰€æœ‰çš„äº‹åŠ¡ä¾æ¬¡é€æ­¥æ‰§è¡Œï¼Œè¿™æ ·äº‹åŠ¡ä¹‹é—´å°±å®Œå…¨ä¸å¯èƒ½äº§ç”Ÿå¹²æ‰°ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥é˜²æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ä»¥åŠå¹»è¯»ã€‚

MySQL InnoDB å­˜å‚¨å¼•æ“çš„é»˜è®¤æ”¯æŒçš„éš”ç¦»çº§åˆ«æ˜¯ **REPEATABLE-READï¼ˆå¯é‡è¯»ï¼‰**ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡`SELECT @@tx_isolation;`å‘½ä»¤æ¥æŸ¥çœ‹
```sql
mysql> SELECT @@tx_isolation;
+-----------------+
| @@tx_isolation  |
+-----------------+
| REPEATABLE-READ |
+-----------------+
```
è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼šä¸ SQL æ ‡å‡†ä¸åŒçš„åœ°æ–¹åœ¨äºInnoDB å­˜å‚¨å¼•æ“åœ¨ **REPEATABLE-READï¼ˆå¯é‡è¯»ï¼‰**äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹ä½¿ç”¨çš„æ˜¯Next-Key Lock é”ç®—æ³•ï¼Œå› æ­¤å¯ä»¥é¿å…å¹»è¯»çš„äº§ç”Ÿï¼Œè¿™ä¸å…¶ä»–æ•°æ®åº“ç³»ç»Ÿ(å¦‚ SQL Server)æ˜¯ä¸åŒçš„ã€‚æ‰€ä»¥è¯´InnoDB å­˜å‚¨å¼•æ“çš„é»˜è®¤æ”¯æŒçš„éš”ç¦»çº§åˆ«æ˜¯ REPEATABLE-READï¼ˆå¯é‡è¯»ï¼‰ å·²ç»å¯ä»¥å®Œå…¨ä¿è¯äº‹åŠ¡çš„éš”ç¦»æ€§è¦æ±‚ï¼Œå³è¾¾åˆ°äº† SQLæ ‡å‡†çš„**SERIALIZABLE(å¯ä¸²è¡ŒåŒ–)**éš”ç¦»çº§åˆ«ã€‚å› ä¸ºéš”ç¦»çº§åˆ«è¶Šä½ï¼Œäº‹åŠ¡è¯·æ±‚çš„é”è¶Šå°‘ï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æ•°æ®åº“ç³»ç»Ÿçš„éš”ç¦»çº§åˆ«éƒ½æ˜¯**READ-COMMITTED(è¯»å–æäº¤å†…å®¹):**ï¼Œä½†æ˜¯ä½ è¦çŸ¥é“çš„æ˜¯InnoDB å­˜å‚¨å¼•æ“é»˜è®¤ä½¿ç”¨ **REPEATABLE-READï¼ˆå¯é‡è¯»ï¼‰**å¹¶ä¸ä¼šæœ‰ä»»ä½•æ€§èƒ½æŸå¤±ã€‚InnoDB å­˜å‚¨å¼•æ“åœ¨ **åˆ†å¸ƒå¼äº‹åŠ¡** çš„æƒ…å†µä¸‹ä¸€èˆ¬ä¼šç”¨åˆ°**SERIALIZABLE(å¯ä¸²è¡ŒåŒ–)**éš”ç¦»çº§åˆ«ã€‚
#### ç´¢å¼•ç›¸å…³
![image.png](https://cdn.nlark.com/yuque/0/2020/png/100682/1591450536441-f8bb9ecd-fca7-4366-b9a4-81fcd0927f28.png#align=left&display=inline&height=681&margin=%5Bobject%20Object%5D&name=image.png&originHeight=1361&originWidth=1455&size=367468&status=done&style=none&width=727.5)
#### æœ€å·¦å‰ç¼€åŸåˆ™
MySQLä¸­çš„ç´¢å¼•å¯ä»¥ä»¥ä¸€å®šé¡ºåºå¼•ç”¨å¤šåˆ—ï¼Œè¿™ç§ç´¢å¼•å«ä½œè”åˆç´¢å¼•ã€‚å¦‚Userè¡¨çš„nameå’ŒcityåŠ è”åˆç´¢å¼•å°±æ˜¯(name,city)ï¼Œè€Œæœ€å·¦å‰ç¼€åŸåˆ™æŒ‡çš„æ˜¯ï¼Œå¦‚æœæŸ¥è¯¢çš„æ—¶å€™æŸ¥è¯¢æ¡ä»¶ç²¾ç¡®åŒ¹é…ç´¢å¼•çš„å·¦è¾¹è¿ç»­ä¸€åˆ—æˆ–å‡ åˆ—ï¼Œåˆ™æ­¤åˆ—å°±å¯ä»¥è¢«ç”¨åˆ°ã€‚å¦‚ä¸‹ï¼š
```sql
select * from user where name=xx and city=xx ; ï¼ï¼å¯ä»¥å‘½ä¸­ç´¢å¼•
select * from user where name=xx ; // å¯ä»¥å‘½ä¸­ç´¢å¼•
select * from user where city=xx ; // æ— æ³•å‘½ä¸­ç´¢å¼•
```
è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å¦‚æœä¸¤ä¸ªæ¡ä»¶éƒ½ç”¨ä¸Šäº†ï¼Œä½†æ˜¯é¡ºåºä¸åŒï¼Œå¦‚ `city= xx and name ï¼xx`ï¼Œé‚£ä¹ˆç°åœ¨çš„æŸ¥è¯¢å¼•æ“ä¼šè‡ªåŠ¨ä¼˜åŒ–ä¸ºåŒ¹é…è”åˆç´¢å¼•çš„é¡ºåºï¼Œè¿™æ ·æ˜¯èƒ½å¤Ÿå‘½ä¸­ç´¢å¼•çš„ã€‚ç”±äºæœ€å·¦å‰ç¼€åŸåˆ™ï¼Œåœ¨åˆ›å»ºè”åˆç´¢å¼•æ—¶ï¼Œç´¢å¼•å­—æ®µçš„é¡ºåºéœ€è¦è€ƒè™‘å­—æ®µå€¼å»é‡ä¹‹åçš„ä¸ªæ•°ï¼Œè¾ƒå¤šçš„æ”¾å‰é¢ã€‚ORDER BYå­å¥ä¹Ÿéµå¾ªæ­¤è§„åˆ™ã€‚
#### å¦‚ä½•ä¸ºè¡¨å­—æ®µæ·»åŠ ç´¢å¼•

- æ·»åŠ PRIMARY KEY(ä¸»é”®ç´¢å¼•)
```sql
ALTER TABLE `table_name` ADD PRIMARY KEY ( `column` )
```

- æ·»åŠ UNIQUE(å”¯ä¸€ç´¢å¼•)
```sql
ALTER TABLE `table_name` ADD UNIQUE ( `column` )
```

- æ·»åŠ INDEX(æ™®é€šç´¢å¼•)
```sql
ALTER TABLE `table_name` ADD INDEX index_name ( `column` )
```

- æ·»åŠ FULLTEXT(å…¨æ–‡ç´¢å¼•)
```sql
ALTER TABLE `table_name` ADD FULLTEXT ( `column`)
```

- æ·»åŠ å¤šåˆ—ç´¢å¼•
```sql
ALTER TABLE `table_name` ADD INDEX index_name ( `column1`, `column2`, `column3` )
```
#### ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«
**æ‚²è§‚é”**
æ€»æ˜¯å‡è®¾æœ€åçš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ï¼ˆ**å…±äº«èµ„æºæ¯æ¬¡åªç»™ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ï¼Œå…¶å®ƒçº¿ç¨‹é˜»å¡ï¼Œç”¨å®Œåå†æŠŠèµ„æºè½¬è®©ç»™å…¶å®ƒçº¿ç¨‹**ï¼‰ã€‚ä¼ ç»Ÿçš„å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹å°±ç”¨åˆ°äº†å¾ˆå¤šè¿™ç§é”æœºåˆ¶ï¼Œæ¯”å¦‚è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰ï¼Œéƒ½æ˜¯åœ¨åšæ“ä½œä¹‹å‰å…ˆä¸Šé”ã€‚

**ä¹è§‚é”**
æ€»æ˜¯å‡è®¾æœ€å¥½çš„æƒ…å†µï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·æœºåˆ¶å’ŒCASç®—æ³•å®ç°ã€‚**ä¹è§‚é”é€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡**ï¼Œåƒæ•°æ®åº“æä¾›çš„ç±»ä¼¼äº**write_conditionæœºåˆ¶**ï¼Œå…¶å®éƒ½æ˜¯æä¾›çš„ä¹è§‚é”ã€‚

**ä¸¤ç§é”çš„ä½¿ç”¨åœºæ™¯**
ä»ä¸Šé¢å¯¹ä¸¤ç§é”çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ä¸¤ç§é”å„æœ‰ä¼˜ç¼ºç‚¹ï¼Œä¸å¯è®¤ä¸ºä¸€ç§å¥½äºå¦ä¸€ç§ï¼Œåƒ**ä¹è§‚é”é€‚ç”¨äºå†™æ¯”è¾ƒå°‘çš„æƒ…å†µä¸‹ï¼ˆå¤šè¯»åœºæ™¯ï¼‰**ï¼Œå³å†²çªçœŸçš„å¾ˆå°‘å‘ç”Ÿçš„æ—¶å€™ï¼Œè¿™æ ·å¯ä»¥çœå»äº†é”çš„å¼€é”€ï¼ŒåŠ å¤§äº†ç³»ç»Ÿçš„æ•´ä¸ªååé‡ã€‚ä½†å¦‚æœæ˜¯å¤šå†™çš„æƒ…å†µï¼Œä¸€èˆ¬ä¼šç»å¸¸äº§ç”Ÿå†²çªï¼Œè¿™å°±ä¼šå¯¼è‡´ä¸Šå±‚åº”ç”¨ä¼šä¸æ–­çš„è¿›è¡Œretryï¼Œè¿™æ ·åå€’æ˜¯é™ä½äº†æ€§èƒ½ï¼Œæ‰€ä»¥**ä¸€èˆ¬å¤šå†™çš„åœºæ™¯ä¸‹ç”¨æ‚²è§‚é”å°±æ¯”è¾ƒåˆé€‚ã€‚**
**
#### é”æœºåˆ¶ä¸InnoDBé”ç®—æ³•
**MyISAMå’ŒInnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨çš„é”ï¼š**

- MyISAM é‡‡ç”¨è¡¨çº§é”(table-level locking)ã€‚
- InnoDB æ”¯æŒè¡Œçº§é”(row-level locking)å’Œè¡¨çº§é”,é»˜è®¤ä¸ºè¡Œçº§é”

**è¡¨çº§é”å’Œè¡Œçº§é”å¯¹æ¯”ï¼š**

- **è¡¨çº§é”ï¼š** Mysqlä¸­é”å®š **ç²’åº¦æœ€å¤§** çš„ä¸€ç§é”ï¼Œå¯¹å½“å‰æ“ä½œçš„æ•´å¼ è¡¨åŠ é”ï¼Œå®ç°ç®€å•ï¼Œèµ„æºæ¶ˆè€—ä¹Ÿæ¯”è¾ƒå°‘ï¼ŒåŠ é”å¿«ï¼Œä¸ä¼šå‡ºç°æ­»é”ã€‚å…¶é”å®šç²’åº¦æœ€å¤§ï¼Œè§¦å‘é”å†²çªçš„æ¦‚ç‡æœ€é«˜ï¼Œå¹¶å‘åº¦æœ€ä½ï¼ŒMyISAMå’Œ InnoDBå¼•æ“éƒ½æ”¯æŒè¡¨çº§é”ã€‚
- **è¡Œçº§é”ï¼š** Mysqlä¸­é”å®š **ç²’åº¦æœ€å°** çš„ä¸€ç§é”ï¼Œåªé’ˆå¯¹å½“å‰æ“ä½œçš„è¡Œè¿›è¡ŒåŠ é”ã€‚ è¡Œçº§é”èƒ½å¤§å¤§å‡å°‘æ•°æ®åº“æ“ä½œçš„å†²çªã€‚å…¶åŠ é”ç²’åº¦æœ€å°ï¼Œå¹¶å‘åº¦é«˜ï¼Œä½†åŠ é”çš„å¼€é”€ä¹Ÿæœ€å¤§ï¼ŒåŠ é”æ…¢ï¼Œä¼šå‡ºç°æ­»é”ã€‚

**InnoDBå­˜å‚¨å¼•æ“çš„é”çš„ç®—æ³•æœ‰ä¸‰ç§ï¼š**
> Record lockï¼šå•ä¸ªè¡Œè®°å½•ä¸Šçš„é”
> Gap lockï¼šé—´éš™é”ï¼Œé”å®šä¸€ä¸ªèŒƒå›´ï¼Œä¸åŒ…æ‹¬è®°å½•æœ¬èº«
> Next-key lockï¼šrecord+gap é”å®šä¸€ä¸ªèŒƒå›´ï¼ŒåŒ…å«è®°å½•æœ¬èº«

**ç›¸å…³çŸ¥è¯†ç‚¹ï¼š**
> innodbå¯¹äºè¡Œçš„æŸ¥è¯¢ä½¿ç”¨next-key lock
> Next-locking keyingä¸ºäº†è§£å†³Phantom Problemå¹»è¯»é—®é¢˜
> å½“æŸ¥è¯¢çš„ç´¢å¼•å«æœ‰å”¯ä¸€å±æ€§æ—¶ï¼Œå°†next-key locké™çº§ä¸ºrecord key Gapé”è®¾è®¡çš„ç›®çš„æ˜¯ä¸ºäº†é˜»æ­¢å¤šä¸ªäº‹åŠ¡å°†è®°å½•æ’å…¥åˆ°åŒä¸€èŒƒå›´å†…ï¼Œè€Œè¿™ä¼šå¯¼è‡´å¹»è¯»é—®é¢˜çš„äº§ç”Ÿ æœ‰ä¸¤ç§æ–¹å¼æ˜¾å¼å…³é—­gapé”ï¼šï¼ˆé™¤äº†å¤–é”®çº¦æŸå’Œå”¯ä¸€æ€§æ£€æŸ¥å¤–ï¼Œå…¶ä½™æƒ…å†µä»…ä½¿ç”¨record lockï¼‰ A. å°†äº‹åŠ¡éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºRC B. å°†å‚æ•°innodb_locks_unsafe_for_binlogè®¾ç½®ä¸º1

#### å¤§è¡¨ä¼˜åŒ–
**é™å®šæ•°æ®çš„èŒƒå›´**
> åŠ¡å¿…ç¦æ­¢ä¸å¸¦ä»»ä½•é™åˆ¶æ•°æ®èŒƒå›´æ¡ä»¶çš„æŸ¥è¯¢è¯­å¥ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬å½“ç”¨æˆ·åœ¨æŸ¥è¯¢è®¢å•å†å²çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶åœ¨ä¸€ä¸ªæœˆçš„èŒƒå›´å†…ï¼›

**è¯»/å†™åˆ†ç¦»**
> ç»å…¸çš„æ•°æ®åº“æ‹†åˆ†æ–¹æ¡ˆï¼Œä¸»åº“è´Ÿè´£å†™ï¼Œä»åº“è´Ÿè´£è¯»ï¼›

**å‚ç›´åˆ†åŒº**
> æ ¹æ®æ•°æ®åº“é‡Œé¢æ•°æ®è¡¨çš„ç›¸å…³æ€§è¿›è¡Œæ‹†åˆ†ã€‚ ä¾‹å¦‚ï¼Œç”¨æˆ·è¡¨ä¸­æ—¢æœ‰ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯åˆæœ‰ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¯ä»¥å°†ç”¨æˆ·è¡¨æ‹†åˆ†æˆä¸¤ä¸ªå•ç‹¬çš„è¡¨ï¼Œç”šè‡³æ”¾åˆ°å•ç‹¬çš„åº“åšåˆ†åº“ã€‚ç®€å•æ¥è¯´å‚ç›´æ‹†åˆ†æ˜¯æŒ‡æ•°æ®è¡¨åˆ—çš„æ‹†åˆ†ï¼ŒæŠŠä¸€å¼ åˆ—æ¯”è¾ƒå¤šçš„è¡¨æ‹†åˆ†ä¸ºå¤šå¼ è¡¨ã€‚
> - **å‚ç›´æ‹†åˆ†çš„ä¼˜ç‚¹ï¼š** å¯ä»¥ä½¿å¾—åˆ—æ•°æ®å˜å°ï¼Œåœ¨æŸ¥è¯¢æ—¶å‡å°‘è¯»å–çš„Blockæ•°ï¼Œå‡å°‘I/Oæ¬¡æ•°ã€‚æ­¤å¤–ï¼Œå‚ç›´åˆ†åŒºå¯ä»¥ç®€åŒ–è¡¨çš„ç»“æ„ï¼Œæ˜“äºç»´æŠ¤ã€‚
> - **å‚ç›´æ‹†åˆ†çš„ç¼ºç‚¹ï¼š** ä¸»é”®ä¼šå‡ºç°å†—ä½™ï¼Œéœ€è¦ç®¡ç†å†—ä½™åˆ—ï¼Œå¹¶ä¼šå¼•èµ·Joinæ“ä½œï¼Œå¯ä»¥é€šè¿‡åœ¨åº”ç”¨å±‚è¿›è¡ŒJoinæ¥è§£å†³ã€‚æ­¤å¤–ï¼Œå‚ç›´åˆ†åŒºä¼šè®©äº‹åŠ¡å˜å¾—æ›´åŠ å¤æ‚

**æ°´å¹³åˆ†åŒº**
> ä¿æŒæ•°æ®è¡¨ç»“æ„ä¸å˜ï¼Œé€šè¿‡æŸç§ç­–ç•¥å­˜å‚¨æ•°æ®åˆ†ç‰‡ã€‚è¿™æ ·æ¯ä¸€ç‰‡æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„è¡¨æˆ–è€…åº“ä¸­ï¼Œè¾¾åˆ°äº†åˆ†å¸ƒå¼çš„ç›®çš„ã€‚ æ°´å¹³æ‹†åˆ†å¯ä»¥æ”¯æ’‘éå¸¸å¤§çš„æ•°æ®é‡ã€‚æ°´å¹³æ‹†åˆ†æ˜¯æŒ‡æ•°æ®è¡¨è¡Œçš„æ‹†åˆ†ï¼Œè¡¨çš„è¡Œæ•°è¶…è¿‡200ä¸‡è¡Œæ—¶ï¼Œå°±ä¼šå˜æ…¢ï¼Œè¿™æ—¶å¯ä»¥æŠŠä¸€å¼ çš„è¡¨çš„æ•°æ®æ‹†æˆå¤šå¼ è¡¨æ¥å­˜æ”¾ã€‚ä¸¾ä¸ªä¾‹å­ï¼šæˆ‘ä»¬å¯ä»¥å°†ç”¨æˆ·ä¿¡æ¯è¡¨æ‹†åˆ†æˆå¤šä¸ªç”¨æˆ·ä¿¡æ¯è¡¨ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…å•ä¸€è¡¨æ•°æ®é‡è¿‡å¤§å¯¹æ€§èƒ½é€ æˆå½±å“ã€‚

#### Mysqlé«˜æ€§èƒ½ä¼˜åŒ–è§„èŒƒå»ºè®®
**æ•°æ®åº“å‘½ä»¤è§„èŒƒï¼š**

- æ‰€æœ‰æ•°æ®åº“å¯¹è±¡åç§°å¿…é¡»ä½¿ç”¨å°å†™å­—æ¯å¹¶ç”¨ä¸‹åˆ’çº¿åˆ†å‰²
- æ‰€æœ‰æ•°æ®åº“å¯¹è±¡åç§°ç¦æ­¢ä½¿ç”¨ MySQLä¿ç•™å…³é”®å­—ï¼ˆå¦‚æœè¡¨åä¸­åŒ…å«å…³é”®å­—æŸ¥è¯¢æ—¶ï¼Œéœ€è¦å°†å…¶ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼‰
- æ•°æ®åº“å¯¹è±¡çš„å‘½åè¦èƒ½åšåˆ°è§åè¯†æ„ï¼Œå¹¶ä¸”æœ€åä¸è¦è¶…è¿‡ 32 ä¸ªå­—ç¬¦
- ä¸´æ—¶åº“è¡¨å¿…é¡»ä»¥ tmp_ä¸ºå‰ç¼€å¹¶ä»¥æ—¥æœŸä¸ºåç¼€ï¼Œå¤‡ä»½è¡¨å¿…é¡»ä»¥ bak_ä¸ºå‰ç¼€å¹¶ä»¥æ—¥æœŸ (æ—¶é—´æˆ³) ä¸ºåç¼€
- æ‰€æœ‰å­˜å‚¨ç›¸åŒæ•°æ®çš„åˆ—åå’Œåˆ—ç±»å‹å¿…é¡»ä¸€è‡´ï¼ˆä¸€èˆ¬ä½œä¸ºå…³è”åˆ—ï¼Œå¦‚æœæŸ¥è¯¢æ—¶å…³è”åˆ—ç±»å‹ä¸ä¸€è‡´ä¼šè‡ªåŠ¨è¿›è¡Œæ•°æ®ç±»å‹éšå¼è½¬æ¢ï¼Œä¼šé€ æˆåˆ—ä¸Šçš„ç´¢å¼•å¤±æ•ˆï¼Œå¯¼è‡´æŸ¥è¯¢æ•ˆç‡é™ä½ï¼‰

**æ•°æ®åº“åŸºæœ¬è®¾è®¡è§„èŒƒï¼š**

- æ‰€æœ‰è¡¨å¿…é¡»ä½¿ç”¨ Innodb å­˜å‚¨å¼•æ“æ²¡æœ‰ç‰¹æ®Šè¦æ±‚ï¼ˆå³Innodb æ— æ³•æ»¡è¶³çš„åŠŸèƒ½å¦‚ï¼šåˆ—å­˜å‚¨ï¼Œå­˜å‚¨ç©ºé—´æ•°æ®ç­‰ï¼‰çš„æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¡¨å¿…é¡»ä½¿ç”¨ Innodb å­˜å‚¨å¼•æ“ï¼ˆMySQL5.5 ä¹‹å‰é»˜è®¤ä½¿ç”¨ Myisamï¼Œ5.6 ä»¥åé»˜è®¤çš„ä¸º Innodbï¼‰ã€‚Innodb æ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡Œçº§é”ï¼Œæ›´å¥½çš„æ¢å¤æ€§ï¼Œé«˜å¹¶å‘ä¸‹æ€§èƒ½æ›´å¥½ã€‚
- æ•°æ®åº“å’Œè¡¨çš„å­—ç¬¦é›†ç»Ÿä¸€ä½¿ç”¨ UTF8å…¼å®¹æ€§æ›´å¥½ï¼Œç»Ÿä¸€å­—ç¬¦é›†å¯ä»¥é¿å…ç”±äºå­—ç¬¦é›†è½¬æ¢äº§ç”Ÿçš„ä¹±ç ï¼Œä¸åŒçš„å­—ç¬¦é›†è¿›è¡Œæ¯”è¾ƒå‰éœ€è¦è¿›è¡Œè½¬æ¢ä¼šé€ æˆç´¢å¼•å¤±æ•ˆï¼Œå¦‚æœæ•°æ®åº“ä¸­æœ‰å­˜å‚¨ emoji è¡¨æƒ…çš„éœ€è¦ï¼Œå­—ç¬¦é›†éœ€è¦é‡‡ç”¨ utf8mb4 å­—ç¬¦é›†ã€‚
- æ‰€æœ‰è¡¨å’Œå­—æ®µéƒ½éœ€è¦æ·»åŠ æ³¨é‡Šä½¿ç”¨ comment ä»å¥æ·»åŠ è¡¨å’Œåˆ—çš„å¤‡æ³¨ï¼Œä»ä¸€å¼€å§‹å°±è¿›è¡Œæ•°æ®å­—å…¸çš„ç»´æŠ¤ã€‚
- å°½é‡æ§åˆ¶å•è¡¨æ•°æ®é‡çš„å¤§å°,å»ºè®®æ§åˆ¶åœ¨ 500 ä¸‡ä»¥å†…ã€‚500 ä¸‡å¹¶ä¸æ˜¯ MySQL æ•°æ®åº“çš„é™åˆ¶ï¼Œè¿‡å¤§ä¼šé€ æˆä¿®æ”¹è¡¨ç»“æ„ï¼Œå¤‡ä»½ï¼Œæ¢å¤éƒ½ä¼šæœ‰å¾ˆå¤§çš„é—®é¢˜ã€‚å¯ä»¥ç”¨å†å²æ•°æ®å½’æ¡£ï¼ˆåº”ç”¨äºæ—¥å¿—æ•°æ®ï¼‰ï¼Œåˆ†åº“åˆ†è¡¨ï¼ˆåº”ç”¨äºä¸šåŠ¡æ•°æ®ï¼‰ç­‰æ‰‹æ®µæ¥æ§åˆ¶æ•°æ®é‡å¤§å°ã€‚
- è°¨æ…ä½¿ç”¨ MySQL åˆ†åŒºè¡¨åˆ†åŒºè¡¨åœ¨ç‰©ç†ä¸Šè¡¨ç°ä¸ºå¤šä¸ªæ–‡ä»¶ï¼Œåœ¨é€»è¾‘ä¸Šè¡¨ç°ä¸ºä¸€ä¸ªè¡¨ï¼›è°¨æ…é€‰æ‹©åˆ†åŒºé”®ï¼Œè·¨åˆ†åŒºæŸ¥è¯¢æ•ˆç‡å¯èƒ½æ›´ä½ï¼›å»ºè®®é‡‡ç”¨ç‰©ç†åˆ†è¡¨çš„æ–¹å¼ç®¡ç†å¤§æ•°æ®ã€‚
- å°½é‡åšåˆ°å†·çƒ­æ•°æ®åˆ†ç¦»,å‡å°è¡¨çš„å®½åº¦ MySQL é™åˆ¶æ¯ä¸ªè¡¨æœ€å¤šå­˜å‚¨ 4096 åˆ—ï¼Œå¹¶ä¸”æ¯ä¸€è¡Œæ•°æ®çš„å¤§å°ä¸èƒ½è¶…è¿‡ 65535 å­—èŠ‚ã€‚å‡å°‘ç£ç›˜ IO,ä¿è¯çƒ­æ•°æ®çš„å†…å­˜ç¼“å­˜å‘½ä¸­ç‡ï¼ˆè¡¨è¶Šå®½ï¼ŒæŠŠè¡¨è£…è½½è¿›å†…å­˜ç¼“å†²æ± æ—¶æ‰€å ç”¨çš„å†…å­˜ä¹Ÿå°±è¶Šå¤§,ä¹Ÿä¼šæ¶ˆè€—æ›´å¤šçš„ IOï¼‰ï¼›æ›´æœ‰æ•ˆçš„åˆ©ç”¨ç¼“å­˜ï¼Œé¿å…è¯»å…¥æ— ç”¨çš„å†·æ•°æ®ï¼›ç»å¸¸ä¸€èµ·ä½¿ç”¨çš„åˆ—æ”¾åˆ°ä¸€ä¸ªè¡¨ä¸­ï¼ˆé¿å…æ›´å¤šçš„å…³è”æ“ä½œï¼‰ã€‚
- ç¦æ­¢åœ¨è¡¨ä¸­å»ºç«‹é¢„ç•™å­—æ®µï¼Œé¢„ç•™å­—æ®µçš„å‘½åå¾ˆéš¾åšåˆ°è§åè¯†ä¹‰ã€‚é¢„ç•™å­—æ®µæ— æ³•ç¡®è®¤å­˜å‚¨çš„æ•°æ®ç±»å‹ï¼Œæ‰€ä»¥æ— æ³•é€‰æ‹©åˆé€‚çš„ç±»å‹ã€‚å¯¹é¢„ç•™å­—æ®µç±»å‹çš„ä¿®æ”¹ï¼Œä¼šå¯¹è¡¨è¿›è¡Œé”å®šã€‚
- ç¦æ­¢åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å›¾ç‰‡,æ–‡ä»¶ç­‰å¤§çš„äºŒè¿›åˆ¶æ•°æ®é€šå¸¸æ–‡ä»¶å¾ˆå¤§ï¼Œä¼šçŸ­æ—¶é—´å†…é€ æˆæ•°æ®é‡å¿«é€Ÿå¢é•¿ï¼Œæ•°æ®åº“è¿›è¡Œæ•°æ®åº“è¯»å–æ—¶ï¼Œé€šå¸¸ä¼šè¿›è¡Œå¤§é‡çš„éšæœº IO æ“ä½œï¼Œæ–‡ä»¶å¾ˆå¤§æ—¶ï¼ŒIO æ“ä½œå¾ˆè€—æ—¶ã€‚é€šå¸¸å­˜å‚¨äºæ–‡ä»¶æœåŠ¡å™¨ï¼Œæ•°æ®åº“åªå­˜å‚¨æ–‡ä»¶åœ°å€ä¿¡æ¯ã€‚
- ç¦æ­¢åœ¨çº¿ä¸Šåšæ•°æ®åº“å‹åŠ›æµ‹è¯•ã€‚
- ç¦æ­¢ä»å¼€å‘ç¯å¢ƒ,æµ‹è¯•ç¯å¢ƒç›´æ¥è¿æ¥ç”Ÿæˆç¯å¢ƒæ•°æ®åº“ã€‚

**æ•°æ®åº“å­—æ®µè®¾è®¡è§„èŒƒï¼š**
> **ä¼˜å…ˆé€‰æ‹©ç¬¦åˆå­˜å‚¨éœ€è¦çš„æœ€å°çš„æ•°æ®ç±»å‹**
> **åŸå› ï¼š**
> åˆ—çš„å­—æ®µè¶Šå¤§ï¼Œå»ºç«‹ç´¢å¼•æ—¶æ‰€éœ€è¦çš„ç©ºé—´ä¹Ÿå°±è¶Šå¤§ï¼Œè¿™æ ·ä¸€é¡µä¸­æ‰€èƒ½å­˜å‚¨çš„ç´¢å¼•èŠ‚ç‚¹çš„æ•°é‡ä¹Ÿå°±è¶Šå°‘ä¹Ÿè¶Šå°‘ï¼Œåœ¨éå†æ—¶æ‰€éœ€è¦çš„ IO æ¬¡æ•°ä¹Ÿå°±è¶Šå¤šï¼Œç´¢å¼•çš„æ€§èƒ½ä¹Ÿå°±è¶Šå·®ã€‚
> **æ–¹æ³•ï¼š**
> a.å°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ç±»å‹å­˜å‚¨,å¦‚:å°† IP åœ°å€è½¬æ¢æˆæ•´å½¢æ•°æ®
> MySQL æä¾›äº†ä¸¤ä¸ªæ–¹æ³•æ¥å¤„ç† ip åœ°å€
> inet_aton æŠŠ ip è½¬ä¸ºæ— ç¬¦å·æ•´å‹ (4-8 ä½)
> inet_ntoa æŠŠæ•´å‹çš„ ip è½¬ä¸ºåœ°å€
> æ’å…¥æ•°æ®å‰ï¼Œå…ˆç”¨ inet_aton æŠŠ ip åœ°å€è½¬ä¸ºæ•´å‹ï¼Œå¯ä»¥èŠ‚çœç©ºé—´ï¼Œæ˜¾ç¤ºæ•°æ®æ—¶ï¼Œä½¿ç”¨ inet_ntoa æŠŠæ•´å‹çš„ ip åœ°å€è½¬ä¸ºåœ°å€æ˜¾ç¤ºå³å¯ã€‚
> b.å¯¹äºéè´Ÿå‹çš„æ•°æ® (å¦‚è‡ªå¢ ID,æ•´å‹ IP) æ¥è¯´,è¦ä¼˜å…ˆä½¿ç”¨æ— ç¬¦å·æ•´å‹æ¥å­˜å‚¨
> **åŸå› ï¼š**
> æ— ç¬¦å·ç›¸å¯¹äºæœ‰ç¬¦å·å¯ä»¥å¤šå‡ºä¸€å€çš„å­˜å‚¨ç©ºé—´
> SIGNED INT -2147483648~2147483647
> UNSIGNED INT 0~4294967295
> VARCHAR(N) ä¸­çš„ N ä»£è¡¨çš„æ˜¯å­—ç¬¦æ•°ï¼Œè€Œä¸æ˜¯å­—èŠ‚æ•°ï¼Œä½¿ç”¨ UTF8 å­˜å‚¨ 255 ä¸ªæ±‰å­— Varchar(255)=765 ä¸ªå­—èŠ‚ã€‚è¿‡å¤§çš„é•¿åº¦ä¼šæ¶ˆè€—æ›´å¤šçš„å†…å­˜ã€‚


> **é¿å…ä½¿ç”¨ TEXT,BLOB æ•°æ®ç±»å‹ï¼Œæœ€å¸¸è§çš„ TEXT ç±»å‹å¯ä»¥å­˜å‚¨ 64k çš„æ•°æ®**
> å»ºè®®æŠŠ BLOB æˆ–æ˜¯ TEXT åˆ—åˆ†ç¦»åˆ°å•ç‹¬çš„æ‰©å±•è¡¨ä¸­
> MySQL å†…å­˜ä¸´æ—¶è¡¨ä¸æ”¯æŒ TEXTã€BLOB è¿™æ ·çš„å¤§æ•°æ®ç±»å‹ï¼Œå¦‚æœæŸ¥è¯¢ä¸­åŒ…å«è¿™æ ·çš„æ•°æ®ï¼Œåœ¨æ’åºç­‰æ“ä½œæ—¶ï¼Œå°±ä¸èƒ½ä½¿ç”¨å†…å­˜ä¸´æ—¶è¡¨ï¼Œå¿…é¡»ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨è¿›è¡Œã€‚è€Œä¸”å¯¹äºè¿™ç§æ•°æ®ï¼ŒMySQL è¿˜æ˜¯è¦è¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢ï¼Œä¼šä½¿ sql æ€§èƒ½å˜å¾—å¾ˆå·®ï¼Œä½†æ˜¯ä¸æ˜¯è¯´ä¸€å®šä¸èƒ½ä½¿ç”¨è¿™æ ·çš„æ•°æ®ç±»å‹ã€‚
> å¦‚æœä¸€å®šè¦ä½¿ç”¨ï¼Œå»ºè®®æŠŠ BLOB æˆ–æ˜¯ TEXT åˆ—åˆ†ç¦»åˆ°å•ç‹¬çš„æ‰©å±•è¡¨ä¸­ï¼ŒæŸ¥è¯¢æ—¶ä¸€å®šä¸è¦ä½¿ç”¨ select * è€Œåªéœ€è¦å–å‡ºå¿…è¦çš„åˆ—ï¼Œä¸éœ€è¦ TEXT åˆ—çš„æ•°æ®æ—¶ä¸è¦å¯¹è¯¥åˆ—è¿›è¡ŒæŸ¥è¯¢ã€‚TEXT æˆ– BLOB ç±»å‹åªèƒ½ä½¿ç”¨å‰ç¼€ç´¢å¼•
> å› ä¸ºMySQL[1] å¯¹ç´¢å¼•å­—æ®µé•¿åº¦æ˜¯æœ‰é™åˆ¶çš„ï¼Œæ‰€ä»¥ TEXT ç±»å‹åªèƒ½ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œå¹¶ä¸” TEXT åˆ—ä¸Šæ˜¯ä¸èƒ½æœ‰é»˜è®¤å€¼çš„ã€‚


> **é¿å…ä½¿ç”¨ ENUM ç±»å‹**
> ä¿®æ”¹ ENUM å€¼éœ€è¦ä½¿ç”¨ ALTER è¯­å¥
> ENUM ç±»å‹çš„ ORDER BY æ“ä½œæ•ˆç‡ä½ï¼Œéœ€è¦é¢å¤–æ“ä½œ
> ç¦æ­¢ä½¿ç”¨æ•°å€¼ä½œä¸º ENUM çš„æšä¸¾å€¼


> **å°½å¯èƒ½æŠŠæ‰€æœ‰åˆ—å®šä¹‰ä¸º NOT NULL**
> **åŸå› ï¼š**
> ç´¢å¼• NULL åˆ—éœ€è¦é¢å¤–çš„ç©ºé—´æ¥ä¿å­˜ï¼Œæ‰€ä»¥è¦å ç”¨æ›´å¤šçš„ç©ºé—´
> è¿›è¡Œæ¯”è¾ƒå’Œè®¡ç®—æ—¶è¦å¯¹ NULL å€¼åšç‰¹åˆ«çš„å¤„ç†


> ä½¿ç”¨ TIMESTAMP(4 ä¸ªå­—èŠ‚) æˆ– DATETIME ç±»å‹ (8 ä¸ªå­—èŠ‚) å­˜å‚¨æ—¶é—´
> TIMESTAMP å­˜å‚¨çš„æ—¶é—´èŒƒå›´ 1970-01-01 00:00:01 ~ 2038-01-19-03:14:07
> TIMESTAMP å ç”¨ 4 å­—èŠ‚å’Œ INT ç›¸åŒï¼Œä½†æ¯” INT å¯è¯»æ€§é«˜
> è¶…å‡º TIMESTAMP å–å€¼èŒƒå›´çš„ä½¿ç”¨ DATETIME ç±»å‹å­˜å‚¨
> ç»å¸¸ä¼šæœ‰äººç”¨å­—ç¬¦ä¸²å­˜å‚¨æ—¥æœŸå‹çš„æ•°æ®ï¼ˆä¸æ­£ç¡®çš„åšæ³•ï¼‰
> ç¼ºç‚¹ 1ï¼šæ— æ³•ç”¨æ—¥æœŸå‡½æ•°è¿›è¡Œè®¡ç®—å’Œæ¯”è¾ƒ
> ç¼ºç‚¹ 2ï¼šç”¨å­—ç¬¦ä¸²å­˜å‚¨æ—¥æœŸè¦å ç”¨æ›´å¤šçš„ç©ºé—´


> åŒè´¢åŠ¡ç›¸å…³çš„é‡‘é¢ç±»æ•°æ®å¿…é¡»ä½¿ç”¨ decimal ç±»å‹
> éç²¾å‡†æµ®ç‚¹ï¼šfloat,double
> ç²¾å‡†æµ®ç‚¹ï¼šdecimal
> Decimal ç±»å‹ä¸ºç²¾å‡†æµ®ç‚¹æ•°ï¼Œåœ¨è®¡ç®—æ—¶ä¸ä¼šä¸¢å¤±ç²¾åº¦
> å ç”¨ç©ºé—´ç”±å®šä¹‰çš„å®½åº¦å†³å®šï¼Œæ¯ 4 ä¸ªå­—èŠ‚å¯ä»¥å­˜å‚¨ 9 ä½æ•°å­—ï¼Œå¹¶ä¸”å°æ•°ç‚¹è¦å ç”¨ä¸€ä¸ªå­—èŠ‚
> å¯ç”¨äºå­˜å‚¨æ¯” bigint æ›´å¤§çš„æ•´å‹æ•°æ®

**ç´¢å¼•è®¾è®¡è§„èŒƒ**
> **é™åˆ¶æ¯å¼ è¡¨ä¸Šçš„ç´¢å¼•æ•°é‡,å»ºè®®å•å¼ è¡¨ç´¢å¼•ä¸è¶…è¿‡ 5 ä¸ª**
> ç´¢å¼•å¹¶ä¸æ˜¯è¶Šå¤šè¶Šå¥½ï¼ç´¢å¼•å¯ä»¥æé«˜æ•ˆç‡åŒæ ·å¯ä»¥é™ä½æ•ˆç‡ã€‚
> ç´¢å¼•å¯ä»¥å¢åŠ æŸ¥è¯¢æ•ˆç‡ï¼Œä½†åŒæ ·ä¹Ÿä¼šé™ä½æ’å…¥å’Œæ›´æ–°çš„æ•ˆç‡ï¼Œç”šè‡³æœ‰äº›æƒ…å†µä¸‹ä¼šé™ä½æŸ¥è¯¢æ•ˆç‡ã€‚å› ä¸º MySQL ä¼˜åŒ–å™¨åœ¨é€‰æ‹©å¦‚ä½•ä¼˜åŒ–æŸ¥è¯¢æ—¶ï¼Œä¼šæ ¹æ®ç»Ÿä¸€ä¿¡æ¯ï¼Œå¯¹æ¯ä¸€ä¸ªå¯ä»¥ç”¨åˆ°çš„ç´¢å¼•æ¥è¿›è¡Œè¯„ä¼°ï¼Œä»¥ç”Ÿæˆå‡ºä¸€ä¸ªæœ€å¥½çš„æ‰§è¡Œè®¡åˆ’ï¼Œå¦‚æœåŒæ—¶æœ‰å¾ˆå¤šä¸ªç´¢å¼•éƒ½å¯ä»¥ç”¨äºæŸ¥è¯¢ï¼Œå°±ä¼šå¢åŠ  MySQL ä¼˜åŒ–å™¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’çš„æ—¶é—´ï¼ŒåŒæ ·ä¼šé™ä½æŸ¥è¯¢æ€§èƒ½ã€‚


> **ç¦æ­¢ç»™è¡¨ä¸­çš„æ¯ä¸€åˆ—éƒ½å»ºç«‹å•ç‹¬çš„ç´¢å¼•**
> 5.6 ç‰ˆæœ¬ä¹‹å‰ï¼Œä¸€ä¸ª sql åªèƒ½ä½¿ç”¨åˆ°ä¸€ä¸ªè¡¨ä¸­çš„ä¸€ä¸ªç´¢å¼•ï¼Œ5.6 ä»¥åï¼Œè™½ç„¶æœ‰äº†åˆå¹¶ç´¢å¼•çš„ä¼˜åŒ–æ–¹å¼ï¼Œä½†æ˜¯è¿˜æ˜¯è¿œè¿œæ²¡æœ‰ä½¿ç”¨ä¸€ä¸ªè”åˆç´¢å¼•çš„æŸ¥è¯¢æ–¹å¼å¥½ã€‚

**
> **æ¯ä¸ª Innodb è¡¨å¿…é¡»æœ‰ä¸ªä¸»é”®**
> Innodb æ˜¯ä¸€ç§ç´¢å¼•ç»„ç»‡è¡¨ï¼šæ•°æ®çš„å­˜å‚¨çš„é€»è¾‘é¡ºåºå’Œç´¢å¼•çš„é¡ºåºæ˜¯ç›¸åŒçš„ã€‚æ¯ä¸ªè¡¨éƒ½å¯ä»¥æœ‰å¤šä¸ªç´¢å¼•ï¼Œä½†æ˜¯è¡¨çš„å­˜å‚¨é¡ºåºåªèƒ½æœ‰ä¸€ç§ã€‚
> Innodb æ˜¯æŒ‰ç…§ä¸»é”®ç´¢å¼•çš„é¡ºåºæ¥ç»„ç»‡è¡¨çš„
> - ä¸è¦ä½¿ç”¨æ›´æ–°é¢‘ç¹çš„åˆ—ä½œä¸ºä¸»é”®ï¼Œä¸é€‚ç”¨å¤šåˆ—ä¸»é”®ï¼ˆç›¸å½“äºè”åˆç´¢å¼•ï¼‰
> - ä¸è¦ä½¿ç”¨ UUID,MD5,HASH,å­—ç¬¦ä¸²åˆ—ä½œä¸ºä¸»é”®ï¼ˆæ— æ³•ä¿è¯æ•°æ®çš„é¡ºåºå¢é•¿ï¼‰
> - ä¸»é”®å»ºè®®ä½¿ç”¨è‡ªå¢ ID å€¼


> **å¸¸è§ç´¢å¼•åˆ—å»ºè®®**
> - å‡ºç°åœ¨ SELECTã€UPDATEã€DELETE è¯­å¥çš„ WHERE ä»å¥ä¸­çš„åˆ—
> - åŒ…å«åœ¨ ORDER BYã€GROUP BYã€DISTINCT ä¸­çš„å­—æ®µ
> - å¹¶ä¸è¦å°†ç¬¦åˆ 1 å’Œ 2 ä¸­çš„å­—æ®µçš„åˆ—éƒ½å»ºç«‹ä¸€ä¸ªç´¢å¼•ï¼Œ é€šå¸¸å°† 1ã€2 ä¸­çš„å­—æ®µå»ºç«‹è”åˆç´¢å¼•æ•ˆæœæ›´å¥½
> - å¤šè¡¨ join çš„å…³è”åˆ—


> **å¦‚ä½•é€‰æ‹©ç´¢å¼•åˆ—çš„é¡ºåº**
> å»ºç«‹ç´¢å¼•çš„ç›®çš„æ˜¯ï¼šå¸Œæœ›é€šè¿‡ç´¢å¼•è¿›è¡Œæ•°æ®æŸ¥æ‰¾ï¼Œå‡å°‘éšæœº IOï¼Œå¢åŠ æŸ¥è¯¢æ€§èƒ½ ï¼Œç´¢å¼•èƒ½è¿‡æ»¤å‡ºè¶Šå°‘çš„æ•°æ®ï¼Œåˆ™ä»ç£ç›˜ä¸­è¯»å…¥çš„æ•°æ®ä¹Ÿå°±è¶Šå°‘ã€‚
> - åŒºåˆ†åº¦æœ€é«˜çš„æ”¾åœ¨è”åˆç´¢å¼•çš„æœ€å·¦ä¾§ï¼ˆåŒºåˆ†åº¦=åˆ—ä¸­ä¸åŒå€¼çš„æ•°é‡/åˆ—çš„æ€»è¡Œæ•°ï¼‰
> - å°½é‡æŠŠå­—æ®µé•¿åº¦å°çš„åˆ—æ”¾åœ¨è”åˆç´¢å¼•çš„æœ€å·¦ä¾§ï¼ˆå› ä¸ºå­—æ®µé•¿åº¦è¶Šå°ï¼Œä¸€é¡µèƒ½å­˜å‚¨çš„æ•°æ®é‡è¶Šå¤§ï¼ŒIO æ€§èƒ½ä¹Ÿå°±è¶Šå¥½ï¼‰
> - ä½¿ç”¨æœ€é¢‘ç¹çš„åˆ—æ”¾åˆ°è”åˆç´¢å¼•çš„å·¦ä¾§ï¼ˆè¿™æ ·å¯ä»¥æ¯”è¾ƒå°‘çš„å»ºç«‹ä¸€äº›ç´¢å¼•ï¼‰

###
> **é¿å…å»ºç«‹å†—ä½™ç´¢å¼•å’Œé‡å¤ç´¢å¼•ï¼ˆå¢åŠ äº†æŸ¥è¯¢ä¼˜åŒ–å™¨ç”Ÿæˆæ‰§è¡Œè®¡åˆ’çš„æ—¶é—´ï¼‰**
> - é‡å¤ç´¢å¼•ç¤ºä¾‹ï¼šprimary key(id)ã€index(id)ã€unique index(id)
> - å†—ä½™ç´¢å¼•ç¤ºä¾‹ï¼šindex(a,b,c)ã€index(a,b)ã€index(a)

###
> **å¯¹äºé¢‘ç¹çš„æŸ¥è¯¢ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨è¦†ç›–ç´¢å¼•**
> è¦†ç›–ç´¢å¼•ï¼šå°±æ˜¯åŒ…å«äº†æ‰€æœ‰æŸ¥è¯¢å­—æ®µ (where,select,ordery by,group by åŒ…å«çš„å­—æ®µ) çš„ç´¢å¼•
> **è¦†ç›–ç´¢å¼•çš„å¥½å¤„ï¼š**
> - **é¿å… Innodb è¡¨è¿›è¡Œç´¢å¼•çš„äºŒæ¬¡æŸ¥è¯¢:** Innodb æ˜¯ä»¥èšé›†ç´¢å¼•çš„é¡ºåºæ¥å­˜å‚¨çš„ï¼Œå¯¹äº Innodb æ¥è¯´ï¼ŒäºŒçº§ç´¢å¼•åœ¨å¶å­èŠ‚ç‚¹ä¸­æ‰€ä¿å­˜çš„æ˜¯è¡Œçš„ä¸»é”®ä¿¡æ¯ï¼Œå¦‚æœæ˜¯ç”¨äºŒçº§ç´¢å¼•æŸ¥è¯¢æ•°æ®çš„è¯ï¼Œåœ¨æŸ¥æ‰¾åˆ°ç›¸åº”çš„é”®å€¼åï¼Œè¿˜è¦é€šè¿‡ä¸»é”®è¿›è¡ŒäºŒæ¬¡æŸ¥è¯¢æ‰èƒ½è·å–æˆ‘ä»¬çœŸå®æ‰€éœ€è¦çš„æ•°æ®ã€‚è€Œåœ¨è¦†ç›–ç´¢å¼•ä¸­ï¼ŒäºŒçº§ç´¢å¼•çš„é”®å€¼ä¸­å¯ä»¥è·å–æ‰€æœ‰çš„æ•°æ®ï¼Œé¿å…äº†å¯¹ä¸»é”®çš„äºŒæ¬¡æŸ¥è¯¢ ï¼Œå‡å°‘äº† IO æ“ä½œï¼Œæå‡äº†æŸ¥è¯¢æ•ˆç‡ã€‚
> - **å¯ä»¥æŠŠéšæœº IO å˜æˆé¡ºåº IO åŠ å¿«æŸ¥è¯¢æ•ˆç‡:** ç”±äºè¦†ç›–ç´¢å¼•æ˜¯æŒ‰é”®å€¼çš„é¡ºåºå­˜å‚¨çš„ï¼Œå¯¹äº IO å¯†é›†å‹çš„èŒƒå›´æŸ¥æ‰¾æ¥è¯´ï¼Œå¯¹æ¯”éšæœºä»ç£ç›˜è¯»å–æ¯ä¸€è¡Œçš„æ•°æ® IO è¦å°‘çš„å¤šï¼Œå› æ­¤åˆ©ç”¨è¦†ç›–ç´¢å¼•åœ¨è®¿é—®æ—¶ä¹Ÿå¯ä»¥æŠŠç£ç›˜çš„éšæœºè¯»å–çš„ IO è½¬å˜æˆç´¢å¼•æŸ¥æ‰¾çš„é¡ºåº IOã€‚

###
> **ç´¢å¼• SET è§„èŒƒ**
> **å°½é‡é¿å…ä½¿ç”¨å¤–é”®çº¦æŸ**
> - ä¸å»ºè®®ä½¿ç”¨å¤–é”®çº¦æŸï¼ˆforeign keyï¼‰ï¼Œä½†ä¸€å®šè¦åœ¨è¡¨ä¸è¡¨ä¹‹é—´çš„å…³è”é”®ä¸Šå»ºç«‹ç´¢å¼•
> - å¤–é”®å¯ç”¨äºä¿è¯æ•°æ®çš„å‚ç…§å®Œæ•´æ€§ï¼Œä½†å»ºè®®åœ¨ä¸šåŠ¡ç«¯å®ç°
> - å¤–é”®ä¼šå½±å“çˆ¶è¡¨å’Œå­è¡¨çš„å†™æ“ä½œä»è€Œé™ä½æ€§èƒ½


**æ•°æ®åº“ SQL å¼€å‘è§„èŒƒ**
> **å»ºè®®ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥è¿›è¡Œæ•°æ®åº“æ“ä½œ**
> é¢„ç¼–è¯‘è¯­å¥å¯ä»¥é‡å¤ä½¿ç”¨è¿™äº›è®¡åˆ’ï¼Œå‡å°‘ SQL ç¼–è¯‘æ‰€éœ€è¦çš„æ—¶é—´ï¼Œè¿˜å¯ä»¥è§£å†³åŠ¨æ€ SQL æ‰€å¸¦æ¥çš„ SQL æ³¨å…¥çš„é—®é¢˜ã€‚åªä¼ å‚æ•°ï¼Œæ¯”ä¼ é€’ SQL è¯­å¥æ›´é«˜æ•ˆã€‚ç›¸åŒè¯­å¥å¯ä»¥ä¸€æ¬¡è§£æï¼Œå¤šæ¬¡ä½¿ç”¨ï¼Œæé«˜å¤„ç†æ•ˆç‡ã€‚


> **é¿å…æ•°æ®ç±»å‹çš„éšå¼è½¬æ¢**
> éšå¼è½¬æ¢ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆå¦‚:

```sql
select name,phone from customer where id = '111';
```

> **å……åˆ†åˆ©ç”¨è¡¨ä¸Šå·²ç»å­˜åœ¨çš„ç´¢å¼•**
> é¿å…ä½¿ç”¨åŒ%å·çš„æŸ¥è¯¢æ¡ä»¶ã€‚å¦‚ï¼š`a like '%123%'`ï¼Œï¼ˆå¦‚æœæ— å‰ç½®%,åªæœ‰åç½®%ï¼Œæ˜¯å¯ä»¥ç”¨åˆ°åˆ—ä¸Šçš„ç´¢å¼•çš„ï¼‰ä¸€ä¸ª SQL åªèƒ½åˆ©ç”¨åˆ°å¤åˆç´¢å¼•ä¸­çš„ä¸€åˆ—è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ã€‚å¦‚ï¼šæœ‰ a,b,c åˆ—çš„è”åˆç´¢å¼•ï¼Œåœ¨æŸ¥è¯¢æ¡ä»¶ä¸­æœ‰ a åˆ—çš„èŒƒå›´æŸ¥è¯¢ï¼Œåˆ™åœ¨ b,c åˆ—ä¸Šçš„ç´¢å¼•å°†ä¸ä¼šè¢«ç”¨åˆ°ã€‚
> åœ¨å®šä¹‰è”åˆç´¢å¼•æ—¶ï¼Œå¦‚æœ a åˆ—è¦ç”¨åˆ°èŒƒå›´æŸ¥æ‰¾çš„è¯ï¼Œå°±è¦æŠŠ a åˆ—æ”¾åˆ°è”åˆç´¢å¼•çš„å³ä¾§ï¼Œä½¿ç”¨ left join æˆ– not exists æ¥ä¼˜åŒ– not in æ“ä½œï¼Œå› ä¸º not in ä¹Ÿé€šå¸¸ä¼šä½¿ç”¨ç´¢å¼•å¤±æ•ˆã€‚

###
> **æ•°æ®åº“è®¾è®¡æ—¶ï¼Œåº”è¯¥è¦å¯¹ä»¥åæ‰©å±•è¿›è¡Œè€ƒè™‘**

###
> **ç¨‹åºè¿æ¥ä¸åŒçš„æ•°æ®åº“ä½¿ç”¨ä¸åŒçš„è´¦å·ï¼Œè¿›åˆ¶è·¨åº“æŸ¥è¯¢**
> - ä¸ºæ•°æ®åº“è¿ç§»å’Œåˆ†åº“åˆ†è¡¨ç•™å‡ºä½™åœ°
> - é™ä½ä¸šåŠ¡è€¦åˆåº¦
> - é¿å…æƒé™è¿‡å¤§è€Œäº§ç”Ÿçš„å®‰å…¨é£é™©

###
> ç¦æ­¢ä½¿ç”¨ SELECT * å¿…é¡»ä½¿ç”¨ SELECT <å­—æ®µåˆ—è¡¨> æŸ¥è¯¢
> **åŸå› ï¼š**
> - æ¶ˆè€—æ›´å¤šçš„ CPU å’Œ IO ä»¥ç½‘ç»œå¸¦å®½èµ„æº
> - æ— æ³•ä½¿ç”¨è¦†ç›–ç´¢å¼•
> - å¯å‡å°‘è¡¨ç»“æ„å˜æ›´å¸¦æ¥çš„å½±å“

###
> **ç¦æ­¢ä½¿ç”¨ä¸å«å­—æ®µåˆ—è¡¨çš„ INSERT è¯­å¥**

```sql
insert into values ('a','b','c');
```
åº”ä½¿ç”¨ï¼š
```sql
insert into t(c1,c2,c3) values ('a','b','c');
```
###
> **é¿å…ä½¿ç”¨å­æŸ¥è¯¢ï¼Œå¯ä»¥æŠŠå­æŸ¥è¯¢ä¼˜åŒ–ä¸º join æ“ä½œ**
> é€šå¸¸å­æŸ¥è¯¢åœ¨ in å­å¥ä¸­ï¼Œä¸”å­æŸ¥è¯¢ä¸­ä¸ºç®€å• SQL(ä¸åŒ…å« unionã€group byã€order byã€limit ä»å¥) æ—¶,æ‰å¯ä»¥æŠŠå­æŸ¥è¯¢è½¬åŒ–ä¸ºå…³è”æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–ã€‚
> **å­æŸ¥è¯¢æ€§èƒ½å·®çš„åŸå› ï¼š**
> å­æŸ¥è¯¢çš„ç»“æœé›†æ— æ³•ä½¿ç”¨ç´¢å¼•ï¼Œé€šå¸¸å­æŸ¥è¯¢çš„ç»“æœé›†ä¼šè¢«å­˜å‚¨åˆ°ä¸´æ—¶è¡¨ä¸­ï¼Œä¸è®ºæ˜¯å†…å­˜ä¸´æ—¶è¡¨è¿˜æ˜¯ç£ç›˜ä¸´æ—¶è¡¨éƒ½ä¸ä¼šå­˜åœ¨ç´¢å¼•ï¼Œæ‰€ä»¥æŸ¥è¯¢æ€§èƒ½ä¼šå—åˆ°ä¸€å®šçš„å½±å“ã€‚ç‰¹åˆ«æ˜¯å¯¹äºè¿”å›ç»“æœé›†æ¯”è¾ƒå¤§çš„å­æŸ¥è¯¢ï¼Œå…¶å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“ä¹Ÿå°±è¶Šå¤§ã€‚ç”±äºå­æŸ¥è¯¢ä¼šäº§ç”Ÿå¤§é‡çš„ä¸´æ—¶è¡¨ä¹Ÿæ²¡æœ‰ç´¢å¼•ï¼Œæ‰€ä»¥ä¼šæ¶ˆè€—è¿‡å¤šçš„ CPU å’Œ IO èµ„æºï¼Œäº§ç”Ÿå¤§é‡çš„æ…¢æŸ¥è¯¢ã€‚


> **é¿å…ä½¿ç”¨ JOIN å…³è”å¤ªå¤šçš„è¡¨**
> å¯¹äº MySQL æ¥è¯´ï¼Œæ˜¯å­˜åœ¨å…³è”ç¼“å­˜çš„ï¼Œç¼“å­˜çš„å¤§å°å¯ä»¥ç”± join_buffer_size å‚æ•°è¿›è¡Œè®¾ç½®ã€‚åœ¨ MySQL ä¸­ï¼Œå¯¹äºåŒä¸€ä¸ª SQL å¤šå…³è”ï¼ˆjoinï¼‰ä¸€ä¸ªè¡¨ï¼Œå°±ä¼šå¤šåˆ†é…ä¸€ä¸ªå…³è”ç¼“å­˜ï¼Œå¦‚æœåœ¨ä¸€ä¸ª SQL ä¸­å…³è”çš„è¡¨è¶Šå¤šï¼Œæ‰€å ç”¨çš„å†…å­˜ä¹Ÿå°±è¶Šå¤§ã€‚å¦‚æœç¨‹åºä¸­å¤§é‡çš„ä½¿ç”¨äº†å¤šè¡¨å…³è”çš„æ“ä½œï¼ŒåŒæ—¶ join_buffer_size è®¾ç½®çš„ä¹Ÿä¸åˆç†çš„æƒ…å†µä¸‹ï¼Œå°±å®¹æ˜“é€ æˆæœåŠ¡å™¨å†…å­˜æº¢å‡ºçš„æƒ…å†µï¼Œå°±ä¼šå½±å“åˆ°æœåŠ¡å™¨æ•°æ®åº“æ€§èƒ½çš„ç¨³å®šæ€§ã€‚åŒæ—¶å¯¹äºå…³è”æ“ä½œæ¥è¯´ï¼Œä¼šäº§ç”Ÿä¸´æ—¶è¡¨æ“ä½œï¼Œå½±å“æŸ¥è¯¢æ•ˆç‡ï¼ŒMySQL æœ€å¤šå…è®¸å…³è” 61 ä¸ªè¡¨ï¼Œå»ºè®®ä¸è¶…è¿‡ 5 ä¸ªã€‚

**
> **å‡å°‘åŒæ•°æ®åº“çš„äº¤äº’æ¬¡æ•°**
> æ•°æ®åº“æ›´é€‚åˆå¤„ç†æ‰¹é‡æ“ä½œï¼Œåˆå¹¶å¤šä¸ªç›¸åŒçš„æ“ä½œåˆ°ä¸€èµ·ï¼Œå¯ä»¥æé«˜å¤„ç†æ•ˆç‡ã€‚

###
> **å¯¹åº”åŒä¸€åˆ—è¿›è¡Œ or åˆ¤æ–­æ—¶ï¼Œä½¿ç”¨ in ä»£æ›¿ or**
> in çš„å€¼ä¸è¦è¶…è¿‡ 500 ä¸ªï¼Œin æ“ä½œå¯ä»¥æ›´æœ‰æ•ˆçš„åˆ©ç”¨ç´¢å¼•ï¼Œor å¤§å¤šæ•°æƒ…å†µä¸‹å¾ˆå°‘èƒ½åˆ©ç”¨åˆ°ç´¢å¼•ã€‚

###
> **ç¦æ­¢ä½¿ç”¨ order by rand() è¿›è¡Œéšæœºæ’åº**
> order by rand() ä¼šæŠŠè¡¨ä¸­æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ•°æ®è£…è½½åˆ°å†…å­˜ä¸­ï¼Œç„¶ååœ¨å†…å­˜ä¸­å¯¹æ‰€æœ‰æ•°æ®æ ¹æ®éšæœºç”Ÿæˆçš„å€¼è¿›è¡Œæ’åºï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¯¹æ¯ä¸€è¡Œéƒ½ç”Ÿæˆä¸€ä¸ªéšæœºå€¼ï¼Œå¦‚æœæ»¡è¶³æ¡ä»¶çš„æ•°æ®é›†éå¸¸å¤§ï¼Œå°±ä¼šæ¶ˆè€—å¤§é‡çš„ CPU å’Œ IO åŠå†…å­˜èµ„æºã€‚æ¨èåœ¨ç¨‹åºä¸­è·å–ä¸€ä¸ªéšæœºå€¼ï¼Œç„¶åä»æ•°æ®åº“ä¸­è·å–æ•°æ®çš„æ–¹å¼ã€‚

**
> **WHERE ä»å¥ä¸­ç¦æ­¢å¯¹åˆ—è¿›è¡Œå‡½æ•°è½¬æ¢å’Œè®¡ç®—**
> å¯¹åˆ—è¿›è¡Œå‡½æ•°è½¬æ¢æˆ–è®¡ç®—æ—¶ä¼šå¯¼è‡´æ— æ³•ä½¿ç”¨ç´¢å¼•

**ä¸æ¨èï¼š**
```sql
where date(create_time)='20190101'
```
**æ¨èï¼š**
```sql
where create_time >= '20190101' and create_time < '20190102'
```
###
> **åœ¨æ˜æ˜¾ä¸ä¼šæœ‰é‡å¤å€¼æ—¶ä½¿ç”¨ UNION ALL è€Œä¸æ˜¯ UNION**
> - UNION ä¼šæŠŠä¸¤ä¸ªç»“æœé›†çš„æ‰€æœ‰æ•°æ®æ”¾åˆ°ä¸´æ—¶è¡¨ä¸­åå†è¿›è¡Œå»é‡æ“ä½œ
> - UNION ALL ä¸ä¼šå†å¯¹ç»“æœé›†è¿›è¡Œå»é‡æ“ä½œ

###
> **æ‹†åˆ†å¤æ‚çš„å¤§ SQL ä¸ºå¤šä¸ªå° SQL**
> - å¤§ SQL é€»è¾‘ä¸Šæ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦å ç”¨å¤§é‡ CPU è¿›è¡Œè®¡ç®—çš„ SQL
> - MySQL ä¸­ï¼Œä¸€ä¸ª SQL åªèƒ½ä½¿ç”¨ä¸€ä¸ª CPU è¿›è¡Œè®¡ç®—
> - SQL æ‹†åˆ†åå¯ä»¥é€šè¿‡å¹¶è¡Œæ‰§è¡Œæ¥æé«˜å¤„ç†æ•ˆç‡


> **ä¸€åƒè¡ŒMysqlç¬”è®°ï¼š**[Mysqlç¬”è®°](https://mp.weixin.qq.com/s?__biz=Mzg2OTA0Njk0OA==&mid=2247485025&idx=1&sn=1f4e19fc77af28f6795feff6ce7465b9&chksm=cea249aaf9d5c0bc89a421c0759d27af3f55797a5fcff0111308307eff54fc4321c45ceb97ad&token=283141110&lang=zh_CN#rd)